#!/bin/bash
# Manual Deployment Helper for CentOS-Docker Agent

echo "ðŸš€ ASHD Agent Deployment Helper"
echo "=================================="
echo "Target: 192.168.50.198 (centos-docker)"
echo ""

echo "ðŸ“‹ Step 1: Copy deployment scripts"
echo "-----------------------------------"
echo "Run these commands from your local machine:"
echo ""
echo "scp deploy_centos_docker_agent.sh root@192.168.50.198:/root/"
echo "scp fix_ntp_centos_docker.sh root@192.168.50.198:/root/"
echo ""

echo "ðŸ“‹ Step 2: Connect to centos-docker"
echo "-----------------------------------"
echo "ssh root@192.168.50.198"
echo ""

echo "ðŸ“‹ Step 3: Run NTP configuration"
echo "-----------------------------------"
echo "Once connected to centos-docker, run:"
echo "sudo ./fix_ntp_centos_docker.sh"
echo ""

echo "ðŸ“‹ Step 4: Deploy ASHD agent"
echo "-----------------------------------"
echo "sudo ./deploy_centos_docker_agent.sh"
echo ""

echo "ðŸ“‹ Step 5: Verify deployment"
echo "-----------------------------------"
echo "systemctl status snmpd"
echo "systemctl status ntpd"
echo "systemctl status ashd-agent"
echo ""
echo "snmpwalk -v2c -c public localhost 1.3.6.1.2.1.1.1.0"
echo "ntpq -p"
echo "journalctl -u ashd-agent -f"
echo ""

echo "ðŸ“‹ Step 6: Return to local machine"
echo "-----------------------------------"
echo "exit"
echo ""

echo "ðŸ“‹ Step 7: Check ASHD dashboard"
echo "-----------------------------------"
echo "Open: http://localhost:8001"
echo "Check Configuration page for SNMP status"
echo "Check Overview page for protocol health"
echo ""

echo "ðŸŽ¯ Expected Results:"
echo "-------------------"
echo "âœ… SNMP: OK Â· centos-docker responding"
echo "âœ… NTP: OK Â· Time synchronized"
echo "âœ… Agent: OK Â· Metrics reporting"
echo ""

echo "ðŸ“š Documentation:"
echo "----------------"
echo "Full guide: docs/CENTOS_DOCKER_DEPLOYMENT.md"
echo "Status report: agent_status_report.json"
echo ""

echo "ðŸ”§ Troubleshooting:"
echo "------------------"
echo "If SNMP fails: check firewall (port 161)"
echo "If NTP fails: check network connectivity"
echo "If agent fails: check Python dependencies"
echo ""

echo "ðŸ’¡ Quick Test Commands (on centos-docker):"
echo "----------------------------------------"
echo "# Test SNMP"
echo "snmpwalk -v2c -c public localhost 1.3.6.1.2.1.1.1.0"
echo ""
echo "# Check services"
echo "systemctl status snmpd ntpd ashd-agent"
echo ""
echo "# Check ports"
echo "netstat -ulnp | grep -E ':161|:123'"
echo ""
echo "# Check logs"
echo "journalctl -u snmpd -u ntpd -u ashd-agent --since '1 minute ago'"
