# =============================================================================
# Kickstart file â€” Rocky Linux 9 Automated Install
# Served at: http://SERVER_IP/ks/rocky9-ks.cfg
# =============================================================================

# Installation method
url --url="http://SERVER_IP/pxe/rocky9"

# Language and locale
lang en_US.UTF-8
keyboard us
timezone UTC --utc

# Network (DHCP during install)
network --bootproto=dhcp --device=link --activate

# Security
firewall --enabled --service=ssh
selinux --enforcing

# Root password (change this! generate with: python3 -c "import crypt; print(crypt.crypt('yourpassword'))")
rootpw --iscrypted $6$rounds=4096$changeThisSalt$CHANGE_ME_USE_HASHED_PASSWORD

# Create a default user
user --name=admin --groups=wheel --password=$6$rounds=4096$changeThisSalt$CHANGE_ME_USE_HASHED_PASSWORD --iscrypted

# Boot loader
bootloader --location=mbr --boot-drive=sda

# Disk partitioning (adjust sda to your disk)
clearpart --all --drives=sda --initlabel
autopart --type=lvm

# Do not use graphical install
text

# Skip X configuration
skipx

# Reboot after install
reboot

# Package selection
%packages --ignoremissing
@^minimal-environment
@core
openssh-server
vim
curl
wget
tar
git
%end

# Post-install script
%post --log=/root/ks-post.log
# Enable SSH
systemctl enable sshd

# Update all packages
dnf update -y

echo "Kickstart installation complete." >> /root/ks-post.log
%end
